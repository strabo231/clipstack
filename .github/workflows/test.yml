name: Test ClipStack

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: Install xclip
      run: sudo apt-get update && sudo apt-get install -y xclip
    
    - name: Make executable
      run: chmod +x clipstack
    
    - name: Test help
      run: ./clipstack --help
    
    - name: Test version
      run: ./clipstack --version
    
    - name: Shellcheck
      run: sudo apt-get install -y shellcheck && shellcheck clipstack || true
    
    - name: Structure check
      run: |
        grep -q "show_history()" clipstack
        grep -q "search_history()" clipstack
        grep -q "watch_clipboard()" clipstack
